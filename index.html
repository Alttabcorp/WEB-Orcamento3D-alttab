<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alttabcorp - Sistema Interno de Or√ßamentos 3D</title>
    <meta name="description" content="Sistema interno da Alttabcorp para funcion√°rios calcularem custos de impress√£o 3D">
    <meta name="keywords" content="impress√£o 3D, or√ßamento, calculadora, custos, Alttabcorp, sistema interno">
    <meta name="author" content="Alttabcorp - Sistema Interno">

    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- √çcones e Manifest -->
    <link rel="icon" type="image/png" href="assets/images/icons/favicon.ico">
    <link rel="icon" type="image/x-icon" href="assets/images/icons/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/icons/icon.jpg">
    
    <!-- Preload para performance -->
    <link rel="preload" href="js/app.js" as="script">
    <link rel="preload" href="js/modules/calculator.js" as="script">

</head>
<body>
    <!-- Loading Spinner -->
    <div id="loading-spinner" class="loading-overlay">
        <div class="spinner"></div>
        <p>Carregando sistema...</p>
    </div>

    <div class="container">
        <header>
            <div class="header-content">
                <h1>üñ®Ô∏è Sistema de Or√ßamentos 3D - Alttabcorp</h1>
                <p>Ferramenta interna para funcion√°rios calcularem custos de impress√£o 3D</p>
                <div class="header-actions">
                    <button type="button" id="btn-ajuda" class="btn btn-info" title="Ajuda (F1)">
                        ‚ùì Ajuda
                    </button>
                </div>
            </div>
        </header>

        <!-- Status da Aplica√ß√£o -->
        <div id="app-status" class="status-bar" style="display: none;">
            <span id="status-text">Sistema inicializando...</span>
            <div class="status-indicator" id="status-indicator"></div>
        </div>

        <form id="orcamentoForm" class="main-form">
            <!-- Calculadora de Impress√£o 3D - Se√ß√£o Principal -->
            <section class="form-section calculadora-section priority-section">
                <div class="section-header">
                    <h2>üñ®Ô∏è Calculadora de Impress√£o 3D</h2>
                    <p class="section-description">
                        Insira o tempo e peso para calcular automaticamente os custos de impress√£o
                    </p>
                </div>
                
                <div class="calculadora-inputs">
                    <div class="form-group">
                        <label for="tempo-impressao">
                            ‚è±Ô∏è Tempo de Impress√£o (horas)
                            <span class="required">*</span>
                        </label>
                        <input 
                            type="number" 
                            id="tempo-impressao" 
                            name="tempo-impressao"
                            step="0.01" 
                            min="0.01" 
                            placeholder="Ex: 4.56"
                            title="Tempo total estimado para imprimir a pe√ßa em horas"
                            required
                            autocomplete="off">
                        <small class="field-hint">Tempo total estimado de impress√£o</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="peso-peca">
                            ‚öñÔ∏è Peso da Pe√ßa (gramas)
                            <span class="required">*</span>
                        </label>
                        <input 
                            type="number" 
                            id="peso-peca" 
                            name="peso-peca"
                            step="0.01" 
                            min="0" 
                            placeholder="Ex: 14.00"
                            title="Peso do filamento necess√°rio em gramas"
                            required
                            autocomplete="off">
                        <small class="field-hint">Peso do filamento usado na impress√£o</small>
                    </div>
                </div>

                <div class="calculadora-actions">
                    <button type="button" id="calcular-custo" class="btn btn-primary">
                        üßÆ Calcular Custo
                    </button>
                    <button type="button" id="limpar-calculo" class="btn btn-secondary">
                        üóëÔ∏è Limpar
                    </button>
                </div>

                <!-- Resultado do C√°lculo -->
                <div id="resultado-calculo" class="resultado-section" style="display: none;">
                    <div class="resultado-header">
                        <h3>üìä Resultado do C√°lculo</h3>
                        <button type="button" id="btn-expandir-detalhes" class="btn btn-link">
                            üìã Ver Detalhes
                        </button>
                    </div>
                    
                    <div class="resultado-destaque">
                        <div class="custo-principal">
                            <span class="label">Custo Total por Unidade</span>
                            <span class="valor" id="custo-total-display">R$ 0,00</span>
                        </div>
                    </div>

                    <!-- Detalhes Expandidos -->
                    <div id="detalhes-custos" class="detalhes-section" style="display: none;">
                        <h4>üí∞ Detalhamento de Custos</h4>
                        <div class="resultado-grid">
                            <div class="resultado-item">
                                <strong>üßµ Custo do Filamento</strong>
                                <div class="resultado-valor" id="custo-filamento-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>‚ö° Custo Energ√©tico</strong>
                                <div class="resultado-valor" id="custo-energetico-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>üì¶ Acess√≥rios/Embalagem</strong>
                                <div class="resultado-valor" id="custo-acessorios-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>üè¢ Custo Fixo por Unidade</strong>
                                <div class="resultado-valor" id="custo-fixo-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>üîß Amortiza√ß√£o</strong>
                                <div class="resultado-valor" id="amortizacao-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>‚ùå Custo de Falha</strong>
                                <div class="resultado-valor" id="custo-falha-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>üìä Imposto</strong>
                                <div class="resultado-valor" id="custo-imposto-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>üí≥ Taxa do Cart√£o</strong>
                                <div class="resultado-valor" id="custo-taxa-cartao-display">R$ 0,00</div>
                            </div>
                            <div class="resultado-item">
                                <strong>üì¢ Custo de An√∫ncio</strong>
                                <div class="resultado-valor" id="custo-anuncio-display">R$ 0,00</div>
                            </div>
                        </div>

                        <h4>üí≤ Pre√ßos de Venda Sugeridos</h4>
                        <div class="precos-venda">
                            <div class="preco-item preco-consumidor">
                                <span class="preco-label">üõí Pre√ßo Consumidor Final</span>
                                <span class="preco-valor" id="preco-consumidor-display">R$ 0,00</span>
                                <span class="lucro-info">Lucro: <span id="lucro-consumidor-display">R$ 0,00</span></span>
                            </div>
                            <div class="preco-item preco-lojista">
                                <span class="preco-label">üè™ Pre√ßo Lojista</span>
                                <span class="preco-valor" id="preco-lojista-display">R$ 0,00</span>
                                <span class="lucro-info">Lucro: <span id="lucro-lojista-display">R$ 0,00</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Dados do Cliente -->
            <section class="form-section client-section">
                <div class="section-header">
                    <h2>üë§ Dados do Cliente</h2>
                    <p class="section-description">Informa√ß√µes opcionais do cliente (podem ser preenchidas posteriormente)</p>
                </div>
                
                <div class="client-grid">
                    <div class="form-group">
                        <label for="nomeCliente">
                            Nome Completo
                        </label>
                        <input 
                            type="text" 
                            id="nomeCliente" 
                            name="nomeCliente" 
                            placeholder="Ex: Jo√£o Silva"
                            autocomplete="name">
                        <div class="validation-feedback" id="nome-feedback"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="emailCliente">
                            E-mail
                        </label>
                        <input 
                            type="email" 
                            id="emailCliente" 
                            name="emailCliente" 
                            placeholder="joao@exemplo.com"
                            autocomplete="email">
                        <div class="validation-feedback" id="email-feedback"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="telefoneCliente">
                            Telefone
                        </label>
                        <input 
                            type="tel" 
                            id="telefoneCliente" 
                            name="telefoneCliente" 
                            placeholder="(11) 99999-9999"
                            autocomplete="tel">
                        <div class="validation-feedback" id="telefone-feedback"></div>
                    </div>
                </div>
            </section>

            <!-- Detalhes do Projeto -->
            <section class="form-section project-section">
                <div class="section-header">
                    <h2>üìã Detalhes do Projeto</h2>
                    <p class="section-description">Especifica√ß√µes e caracter√≠sticas do projeto</p>
                </div>
                
                <div class="project-grid">
                    <div class="form-group">
                        <label for="imagemProjeto">
                            üì∑ Imagem do Projeto (opcional)
                        </label>
                        <input 
                            type="file" 
                            id="imagemProjeto" 
                            name="imagemProjeto" 
                            accept="image/*"
                            title="Selecione uma imagem para incluir no relat√≥rio">
                        <small class="field-hint">Imagem ser√° redimensionada automaticamente para o PDF</small>
                        
                        <!-- Preview da imagem -->
                        <div id="preview-imagem" style="display: none; margin-top: 1rem;">
                            <div style="border: 2px dashed #007bff; border-radius: 8px; padding: 1rem; text-align: center;">
                                <img id="img-preview" src="" alt="Preview" style="max-width: 200px; max-height: 150px; border-radius: 4px;">
                                <div style="margin-top: 0.5rem;">
                                    <span id="img-info" style="font-size: 0.8rem; color: #6c757d;"></span>
                                    <button type="button" id="btn-remover-imagem" style="margin-left: 1rem; padding: 0.25rem 0.5rem; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                        ‚ùå Remover
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="prazoEntrega">
                            Prazo de Entrega (dias)
                        </label>
                        <input 
                            type="number" 
                            id="prazoEntrega" 
                            name="prazoEntrega" 
                            min="1" 
                            max="365"
                            placeholder="Ex: 7"
                            title="Quantos dias √∫teis voc√™ precisa para entregar o projeto">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="descricaoProjeto">
                        Descri√ß√£o Detalhada do Projeto
                    </label>
                    <textarea 
                        id="descricaoProjeto" 
                        name="descricaoProjeto" 
                        rows="4" 
                        placeholder="Descreva detalhadamente o que precisa ser desenvolvido, incluindo especifica√ß√µes t√©cnicas, materiais, acabamentos, etc."></textarea>
                    <small class="field-hint">
                        <span id="desc-counter">0</span>/500 caracteres
                    </small>
                </div>
            </section>



            <!-- A√ß√µes Principais -->
            <div class="form-actions main-actions">
                <button type="submit" class="btn btn-primary btn-large">
                    üìÑ Gerar Or√ßamento PDF
                </button>
                <button type="reset" class="btn btn-secondary">
                    üîÑ Limpar Formul√°rio
                </button>
            </div>
        </form>

        <!-- Resumo Lateral (Mobile: oculto por padr√£o) -->
        <aside id="resumo-orcamento" class="resumo-sidebar" style="display: none;">
            <div class="resumo-header">
                <h3>üìã Resumo do Or√ßamento</h3>
                <button type="button" id="btn-fechar-resumo" class="btn-close">&times;</button>
            </div>
            <div class="resumo-content">
                <div class="resumo-item">
                    <span class="resumo-label">Cliente:</span>
                    <span class="resumo-valor" id="resumo-cliente">-</span>
                </div>
                <div class="resumo-item">
                    <span class="resumo-label">Projeto:</span>
                    <span class="resumo-valor" id="resumo-projeto">-</span>
                </div>
                <div class="resumo-item">
                    <span class="resumo-label">Custo Total:</span>
                    <span class="resumo-valor destaque" id="resumo-custo">R$ 0,00</span>
                </div>
                <div class="resumo-item">
                    <span class="resumo-label">Pre√ßo Final:</span>
                    <span class="resumo-valor destaque" id="resumo-preco">R$ 0,00</span>
                </div>
            </div>
            <div class="resumo-actions">
                <button type="button" id="btn-preview-pdf" class="btn btn-outline btn-small">
                    üëÅÔ∏è Preview
                </button>
            </div>
        </aside>
    </div>

    <!-- Rodap√© -->
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Alttabcorp</h4>
                <p>Sistema interno de or√ßamentos 3D</p>
                <p>Uso exclusivo para funcion√°rios</p>
            </div>
            <div class="footer-section">
                <h4>Contato</h4>
                <p>üìß contato@alttabcorp.com.br</p>
                <p>üåê www.alttabcorp.com.br</p>
            </div>
            <div class="footer-section">
                <h4>Vers√£o</h4>
                <p>v1.0.0 - Setembro 2025</p>
                <p id="app-version-info">Sistema carregando...</p>
            </div>
        </div>
    </footer>
    <!-- jsPDF UMD -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        window.jsPDF = window.jspdf.jsPDF;
    </script>
    
    <!-- M√≥dulos da aplica√ß√£o -->
    <script src="js/utils/formatting.js"></script>
    <script src="js/modules/calculator.js"></script>
    <script src="js/modules/config.js"></script>
    <script src="js/modules/pdfGenerator.js"></script>
    <script src="js/modules/calculadoraInterface.js"></script>
    <script src="js/modules/interfaceManager.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Arquivo legado para compatibilidade -->
    <script src="assets/js/orcamento.js"></script>

    <!-- Script para preview de imagem -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputImagem = document.getElementById('imagemProjeto');
            const previewContainer = document.getElementById('preview-imagem');
            const imgPreview = document.getElementById('img-preview');
            const imgInfo = document.getElementById('img-info');
            const btnRemover = document.getElementById('btn-remover-imagem');

            // Handler para mudan√ßa no input de arquivo
            inputImagem.addEventListener('change', function(e) {
                const arquivo = e.target.files[0];
                
                if (arquivo) {
                    // Validar tipo de arquivo
                    if (!arquivo.type.startsWith('image/')) {
                        alert('Por favor, selecione apenas arquivos de imagem.');
                        this.value = '';
                        return;
                    }
                    
                    // Validar tamanho (m√°ximo 5MB)
                    if (arquivo.size > 5 * 1024 * 1024) {
                        alert('A imagem deve ter no m√°ximo 5MB.');
                        this.value = '';
                        return;
                    }
                    
                    // Criar URL da imagem e mostrar preview
                    const url = URL.createObjectURL(arquivo);
                    imgPreview.src = url;
                    
                    // Mostrar informa√ß√µes do arquivo
                    const tamanhoMB = (arquivo.size / (1024 * 1024)).toFixed(2);
                    imgInfo.textContent = `${arquivo.name} (${tamanhoMB} MB)`;
                    
                    // Mostrar container de preview
                    previewContainer.style.display = 'block';
                } else {
                    // Esconder preview se nenhum arquivo selecionado
                    previewContainer.style.display = 'none';
                }
            });

            // Handler para remover imagem
            btnRemover.addEventListener('click', function() {
                inputImagem.value = '';
                previewContainer.style.display = 'none';
                
                // Limpar URL objeto para evitar vazamentos de mem√≥ria
                if (imgPreview.src.startsWith('blob:')) {
                    URL.revokeObjectURL(imgPreview.src);
                }
                imgPreview.src = '';
                imgInfo.textContent = '';
            });
        });
    </script>
</body>
</html>